<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARTCC/FIR Topology Network Graph</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1a2e; color: #eee; }
        .container { display: flex; height: 100vh; }
        #network { flex: 1; background: #16213e; }
        .sidebar { width: 320px; background: #0f3460; padding: 20px; overflow-y: auto; }
        h1 { font-size: 1.2em; margin-bottom: 15px; color: #e94560; }
        h2 { font-size: 1em; margin: 15px 0 10px; color: #00fff5; border-bottom: 1px solid #00fff577; padding-bottom: 5px; }
        .filter-group { margin-bottom: 15px; }
        label { display: block; margin: 5px 0; cursor: pointer; font-size: 0.9em; }
        input[type="checkbox"] { margin-right: 8px; }
        .legend { margin-top: 20px; }
        .legend-item { display: flex; align-items: center; margin: 5px 0; font-size: 0.85em; }
        .legend-color { width: 20px; height: 20px; border-radius: 50%; margin-right: 10px; border: 2px solid #fff; }
        .tier-groups { margin-top: 15px; }
        .tier-group { background: #1a1a2e; padding: 10px; margin: 8px 0; border-radius: 5px; font-size: 0.85em; cursor: pointer; transition: all 0.2s; }
        .tier-group:hover { background: #2a2a4e; }
        .tier-group.active { border: 2px solid #00fff5; }
        .tier-group-name { color: #e94560; font-weight: bold; }
        .tier-group-members { color: #aaa; margin-top: 5px; }
        .stats { background: #1a1a2e; padding: 10px; border-radius: 5px; margin-top: 15px; font-size: 0.85em; }
        select { width: 100%; padding: 8px; background: #1a1a2e; color: #eee; border: 1px solid #00fff577; border-radius: 4px; font-size: 0.9em; margin-bottom: 10px; }
        .tier-config { background: #1a1a2e; padding: 8px 10px; margin: 5px 0; border-radius: 4px; font-size: 0.85em; cursor: pointer; transition: all 0.2s; }
        .tier-config:hover { background: #2a2a4e; }
        .tier-config.active { border: 2px solid #00fff5; background: #2a2a4e; }
        .tier-config-code { color: #e94560; font-weight: bold; display: inline-block; min-width: 70px; }
        .tier-config-type { color: #00fff5; }
        .tier-config-count { color: #666; font-size: 0.8em; }
        .clear-btn { background: #e94560; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85em; margin-top: 10px; }
        .clear-btn:hover { background: #ff6b8a; }
        .stats div { margin: 3px 0; }
        .highlight { color: #00fff5; }
    </style>
</head>
<body>
    <div class="container">
        <div id="network"></div>
        <div class="sidebar">
            <h1>ARTCC/FIR Topology</h1>

            <h2>Filter by Type</h2>
            <div class="filter-group">
                <label><input type="checkbox" id="showARTCC" checked> US ARTCCs (20)</label>
                <label><input type="checkbox" id="showFIR" checked> Canadian FIRs (8)</label>
                <label><input type="checkbox" id="showOceanic" checked> Oceanic (6)</label>
                <label><input type="checkbox" id="showNorthAtlantic"> North Atlantic (4)</label>
            </div>

            <h2>Edge Types</h2>
            <div class="filter-group">
                <label><input type="checkbox" id="showLateral" checked> Lateral Borders</label>
                <label><input type="checkbox" id="showOceanicEdge" checked> Oceanic Borders</label>
            </div>

            <div class="legend">
                <h2>Legend</h2>
                <div class="legend-item"><div class="legend-color" style="background: #4a90d9;"></div> US ARTCC</div>
                <div class="legend-item"><div class="legend-color" style="background: #e94560;"></div> Canadian FIR</div>
                <div class="legend-item"><div class="legend-color" style="background: #00fff5;"></div> Oceanic</div>
                <div class="legend-item"><div class="legend-color" style="background: #9b59b6;"></div> North Atlantic</div>
            </div>

            <div class="tier-configs">
                <h2>ARTCC Tier Configurations</h2>
                <select id="facilitySelect">
                    <option value="">-- Select Facility --</option>
                    <option value="ALL">ALL (20 ARTCCs)</option>
                    <option value="ALL+Canada">ALL+Canada</option>
                </select>
                <div id="tierConfigList"></div>
                <button class="clear-btn" id="clearHighlight" style="display:none;">Clear Highlight</button>
            </div>

            <div class="tier-groups">
                <h2>Named Tier Groups</h2>
                <div class="tier-group">
                    <div class="tier-group-name">6WEST</div>
                    <div class="tier-group-members">ZLA, ZLC, ZDV, ZOA, ZAB, ZSE</div>
                </div>
                <div class="tier-group">
                    <div class="tier-group-name">10WEST</div>
                    <div class="tier-group-members">ZAB, ZDV, ZFW, ZHU, ZKC, ZLA, ZLC, ZMP, ZOA, ZSE</div>
                </div>
                <div class="tier-group">
                    <div class="tier-group-name">EASTCOAST</div>
                    <div class="tier-group-members">ZBW, ZNY, ZDC, ZJX, ZMA</div>
                </div>
                <div class="tier-group">
                    <div class="tier-group-name">WESTCOAST</div>
                    <div class="tier-group-members">ZSE, ZOA, ZLA</div>
                </div>
                <div class="tier-group">
                    <div class="tier-group-name">GULF</div>
                    <div class="tier-group-members">ZJX, ZMA, ZHU</div>
                </div>
                <div class="tier-group">
                    <div class="tier-group-name">CANWEST</div>
                    <div class="tier-group-members">CZVR, CZEG</div>
                </div>
                <div class="tier-group">
                    <div class="tier-group-name">CANEAST</div>
                    <div class="tier-group-members">CZWG, CZYZ, CZUL, CZQM</div>
                </div>
            </div>

            <div class="stats" id="stats">
                <h2>Statistics</h2>
                <div>Nodes: <span class="highlight" id="nodeCount">0</span></div>
                <div>Edges: <span class="highlight" id="edgeCount">0</span></div>
                <div>Selected: <span class="highlight" id="selectedNode">-</span></div>
            </div>
        </div>
    </div>

    <script>
        // Tier configuration data from TierInfo.csv
        const tierConfigs = {
            'ALL': { select: '(ALL)', facilities: 'ZAB ZAU ZBW ZDC ZDV ZFW ZHU ZID ZJX ZKC ZLA ZLC ZMA ZME ZMP ZNY ZOA ZOB ZSE ZTL' },
            'ALL+Canada': { select: '(ALL+Canada)', facilities: 'ZAB ZAU ZBW ZDC ZDV ZFW ZHU ZID ZJX ZKC ZLA ZLC ZMA ZME ZMP ZNY ZOA ZOB ZSE ZTL CZE CZM CZU CZV CZW CZY CZX' },
            'Manual': { select: '(Manual)', facilities: '' },
            'ZAB': {
                configs: [
                    { code: 'ZABI', select: '(Internal)', facilities: 'ZAB' },
                    { code: 'ZAB1', select: '(1stTier)', facilities: 'ZAB ZLA ZDV ZKC ZFW ZHU' },
                    { code: 'ZAB2', select: '(2ndTier)', facilities: 'ZAB ZLA ZDV ZKC ZFW ZHU ZOA ZLC ZMP ZAU ZID ZME ZTL ZJX' },
                    { code: 'ZAB6W', select: '(6West)', facilities: 'ZLA ZLC ZDV ZOA ZAB ZSE' },
                    { code: 'ZAB10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZAB12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZAU': {
                configs: [
                    { code: 'ZAUI', select: '(Internal)', facilities: 'ZAU' },
                    { code: 'ZAU1', select: '(1stTier)', facilities: 'ZAU ZMP ZKC ZID ZOB' },
                    { code: 'ZAU2', select: '(2ndTier)', facilities: 'ZAU ZMP ZKC ZID ZOB ZLC ZDV ZAB ZFW ZME ZTL ZDC ZNY ZBW' },
                    { code: 'ZAU12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZBW': {
                configs: [
                    { code: 'ZBWI', select: '(Internal)', facilities: 'ZBW' },
                    { code: 'ZBW1', select: '(1stTier)', facilities: 'ZBW ZDC ZNY ZOB' },
                    { code: 'ZBW1C', select: '(1stTier+Canada)', facilities: 'ZBW ZDC ZNY ZOB CYYZ CYOW CYUL' },
                    { code: 'ZBW2', select: '(2ndTier)', facilities: 'ZBW ZDC ZNY ZOB ZMP ZAU ZID ZTL ZJX' },
                    { code: 'ZBWEC', select: '(EastCoast)', facilities: 'ZBW ZNY ZDC ZJX ZMA' }
                ]
            },
            'ZDC': {
                configs: [
                    { code: 'ZDCI', select: '(Internal)', facilities: 'ZDC' },
                    { code: 'ZDC1', select: '(1stTier)', facilities: 'ZDC ZBW ZNY ZOB ZID ZTL ZJX' },
                    { code: 'ZDC2', select: '(2ndTier)', facilities: 'ZDC ZBW ZNY ZOB ZID ZTL ZJX ZMA ZHU ZME ZKC ZAU ZMP' },
                    { code: 'ZDCEC', select: '(EastCoast)', facilities: 'ZBW ZNY ZDC ZJX ZMA' }
                ]
            },
            'ZDV': {
                configs: [
                    { code: 'ZDVI', select: '(Internal)', facilities: 'ZDV' },
                    { code: 'ZDV1', select: '(1stTier)', facilities: 'ZDV ZLC ZLA ZAB ZMP ZKC' },
                    { code: 'ZDV2', select: '(2ndTier)', facilities: 'ZDV ZLC ZLA ZAB ZMP ZKC ZSE ZOA ZFW ZME ZHU ZID ZOB ZAU' },
                    { code: 'ZDV6W', select: '(6West)', facilities: 'ZLA ZLC ZDV ZOA ZAB ZSE' },
                    { code: 'ZDV10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZDV12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZFW': {
                configs: [
                    { code: 'ZFWI', select: '(Internal)', facilities: 'ZFW' },
                    { code: 'ZFW1', select: '(1stTier)', facilities: 'ZFW ZME ZKC ZAB ZHU' },
                    { code: 'ZFW2', select: '(2ndTier)', facilities: 'ZFW ZME ZKC ZAB ZHU ZLA ZDV ZMP ZAU ZID ZTL ZJX ZMA' },
                    { code: 'ZFW10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZFW12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZHU': {
                configs: [
                    { code: 'ZHUI', select: '(Internal)', facilities: 'ZHU' },
                    { code: 'ZHU1', select: '(1stTier)', facilities: 'ZHU ZAB ZFW ZME ZTL ZJX ZMA' },
                    { code: 'ZHU2', select: '(2ndTier)', facilities: 'ZHU ZAB ZFW ZME ZTL ZJX ZMA ZLA ZDV ZKC ZID ZDC' },
                    { code: 'ZHUGULF', select: '(Gulf)', facilities: 'ZJX ZMA ZHU' },
                    { code: 'ZHU10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZHU12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZID': {
                configs: [
                    { code: 'ZIDI', select: '(Internal)', facilities: 'ZID' },
                    { code: 'ZID1', select: '(1stTier)', facilities: 'ZID ZAU ZOB ZDC ZME ZTL ZKC' },
                    { code: 'ZID2', select: '(2ndTier)', facilities: 'ZID ZAU ZOB ZDC ZME ZTL ZKC ZAB ZDV ZFW ZMP ZHU ZJX ZNY ZBW' }
                ]
            },
            'ZJX': {
                configs: [
                    { code: 'ZJXI', select: '(Internal)', facilities: 'ZJX' },
                    { code: 'ZJX1', select: '(1stTier)', facilities: 'ZJX ZMA ZHU ZTL ZDC' },
                    { code: 'ZJX2', select: '(2ndTier)', facilities: 'ZJX ZMA ZHU ZTL ZDC ZAB ZFW ZME ZID ZOB ZNY ZBW' },
                    { code: 'ZJXEC', select: '(EastCoast)', facilities: 'ZBW ZNY ZDC ZJX ZMA' },
                    { code: 'ZJXGULF', select: '(Gulf)', facilities: 'ZJX ZMA ZHU' }
                ]
            },
            'ZKC': {
                configs: [
                    { code: 'ZKCI', select: '(Internal)', facilities: 'ZKC' },
                    { code: 'ZKC1', select: '(1stTier)', facilities: 'ZKC ZMP ZAU ZID ZME ZFW ZAB ZDV' },
                    { code: 'ZKC2', select: '(2ndTier)', facilities: 'ZKC ZMP ZAU ZID ZME ZFW ZAB ZDV ZLC ZLA ZHU ZTL ZDC ZOB' },
                    { code: 'ZKC10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZKC12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZLA': {
                configs: [
                    { code: 'ZLAI', select: '(Internal)', facilities: 'ZLA' },
                    { code: 'ZLA1', select: '(1stTier)', facilities: 'ZLA ZLC ZOA ZDV ZAB' },
                    { code: 'ZLA2', select: '(2ndTier)', facilities: 'ZLA ZLC ZOA ZDV ZAB ZSE ZMP ZKC ZFW ZHU' },
                    { code: 'ZLA6W', select: '(6West)', facilities: 'ZLA ZLC ZDV ZOA ZAB ZSE' },
                    { code: 'ZLA10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZLA12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' },
                    { code: 'ZLAWC', select: '(WestCoast)', facilities: 'ZSE ZOA ZLA' }
                ]
            },
            'ZLC': {
                configs: [
                    { code: 'ZLCI', select: '(Internal)', facilities: 'ZLC' },
                    { code: 'ZLC1', select: '(1stTier)', facilities: 'ZLC ZDV ZLA ZMP ZOA ZSE' },
                    { code: 'ZLC1C', select: '(1stTier+Canada)', facilities: 'ZLC ZDV ZLA ZMP ZOA ZSE CYYZ CYEG' },
                    { code: 'ZLC2', select: '(2ndTier)', facilities: 'ZLC ZDV ZLA ZMP ZOA ZSE ZAB ZKC ZAU ZOB' },
                    { code: 'ZLC6W', select: '(6West)', facilities: 'ZLA ZLC ZDV ZOA ZAB ZSE' },
                    { code: 'ZLC10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZLC12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZMA': {
                configs: [
                    { code: 'ZMAI', select: '(Internal)', facilities: 'ZMA' },
                    { code: 'ZMA1', select: '(1stTier)', facilities: 'ZMA ZJX ZHU' },
                    { code: 'ZMA2', select: '(2ndTier)', facilities: 'ZMA ZJX ZHU ZFW ZME ZTL ZDC' },
                    { code: 'ZMAEC', select: '(EastCoast)', facilities: 'ZBW ZNY ZDC ZJX ZMA' },
                    { code: 'ZMAGULF', select: '(Gulf)', facilities: 'ZJX ZMA ZHU' }
                ]
            },
            'ZME': {
                configs: [
                    { code: 'ZMEI', select: '(Internal)', facilities: 'ZME' },
                    { code: 'ZME1', select: '(1stTier)', facilities: 'ZME ZTL ZID ZKC ZFW ZHU' },
                    { code: 'ZME2', select: '(2ndTier)', facilities: 'ZME ZTL ZID ZKC ZFW ZHU ZAB ZDV ZMP ZAU ZOB ZDC ZJX ZMA' },
                    { code: 'ZME12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZMP': {
                configs: [
                    { code: 'ZMPI', select: '(Internal)', facilities: 'ZMP' },
                    { code: 'ZMP1', select: '(1stTier)', facilities: 'ZMP ZAU ZOB ZKC ZDV ZLC' },
                    { code: 'ZMP1C', select: '(1stTier+Canada)', facilities: 'ZMP ZAU ZOB ZKC ZDV ZLC CYYZ' },
                    { code: 'ZMP2', select: '(2ndTier)', facilities: 'ZMP ZAU ZOB ZKC ZDV ZLC ZSE ZOA ZLA ZAB ZFW ZME ZID ZDC ZNY ZBW' },
                    { code: 'ZMP10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZMP12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' }
                ]
            },
            'ZNY': {
                configs: [
                    { code: 'ZNYI', select: '(Internal)', facilities: 'ZNY' },
                    { code: 'ZNY1', select: '(1stTier)', facilities: 'ZNY ZBW ZDC ZOB' },
                    { code: 'ZNY2', select: '(2ndTier)', facilities: 'ZNY ZBW ZDC ZOB ZMP ZAU ZID ZTL ZJX' },
                    { code: 'ZNYEC', select: '(EastCoast)', facilities: 'ZBW ZNY ZDC ZJX ZMA' }
                ]
            },
            'ZOA': {
                configs: [
                    { code: 'ZOAI', select: '(Internal)', facilities: 'ZOA' },
                    { code: 'ZOA1', select: '(1stTier)', facilities: 'ZOA ZLA ZSE ZLC' },
                    { code: 'ZOA2', select: '(2ndTier)', facilities: 'ZOA ZLA ZSE ZLC ZDV ZAB ZMP' },
                    { code: 'ZOA6W', select: '(6West)', facilities: 'ZLA ZLC ZDV ZOA ZAB ZSE' },
                    { code: 'ZOA10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZOA12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' },
                    { code: 'ZOAWC', select: '(WestCoast)', facilities: 'ZSE ZOA ZLA' }
                ]
            },
            'ZOB': {
                configs: [
                    { code: 'ZOBI', select: '(Internal)', facilities: 'ZOB' },
                    { code: 'ZOB1', select: '(1stTier)', facilities: 'ZOB ZAU ZMP ZID ZDC ZNY ZBW' },
                    { code: 'ZOB1C', select: '(1stTier+Canada)', facilities: 'ZOB ZAU ZMP ZID ZDC ZNY ZBW CYYZ' },
                    { code: 'ZOB2', select: '(2ndTier)', facilities: 'ZOB ZAU ZMP ZID ZDC ZNY ZBW ZLC ZDV ZKC ZME ZTL ZJX' }
                ]
            },
            'ZSE': {
                configs: [
                    { code: 'ZSEI', select: '(Internal)', facilities: 'ZSE' },
                    { code: 'ZSE1', select: '(1stTier)', facilities: 'ZSE ZOA ZLC' },
                    { code: 'ZSE1C', select: '(1stTier+Canada)', facilities: 'ZSE ZOA ZLC CYVR CYYC CYEG' },
                    { code: 'ZSE2', select: '(2ndTier)', facilities: 'ZSE ZOA ZLC ZMP ZDV ZLA' },
                    { code: 'ZSE6W', select: '(6West)', facilities: 'ZLA ZLC ZDV ZOA ZAB ZSE' },
                    { code: 'ZSE10W', select: '(10West)', facilities: 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE' },
                    { code: 'ZSE12W', select: '(12West)', facilities: 'ZAB ZAU ZDV ZFW ZHU ZKC ZLA ZLC ZME ZMP ZOA ZSE' },
                    { code: 'ZSEWC', select: '(WestCoast)', facilities: 'ZSE ZOA ZLA' }
                ]
            },
            'ZTL': {
                configs: [
                    { code: 'ZTLI', select: '(Internal)', facilities: 'ZTL' },
                    { code: 'ZTL1', select: '(1stTier)', facilities: 'ZTL ZID ZDC ZJX ZME ZHU' },
                    { code: 'ZTL2', select: '(2ndTier)', facilities: 'ZTL ZID ZDC ZJX ZME ZHU ZAB ZFW ZKC ZAU ZOB ZNY ZBW ZMA' }
                ]
            }
        };

        // Named tier group definitions
        const namedTierGroups = {
            '6WEST': 'ZLA ZLC ZDV ZOA ZAB ZSE',
            '10WEST': 'ZAB ZDV ZFW ZHU ZKC ZLA ZLC ZMP ZOA ZSE',
            'EASTCOAST': 'ZBW ZNY ZDC ZJX ZMA',
            'WESTCOAST': 'ZSE ZOA ZLA',
            'GULF': 'ZJX ZMA ZHU',
            'CANWEST': 'CZVR CZEG',
            'CANEAST': 'CZWG CZYZ CZUL CZQM'
        };

        // Short code to full code mapping for Canadian FIRs
        const shortCodeMap = {
            'CZE': 'CZEG', 'CZM': 'CZQM', 'CZU': 'CZUL', 'CZV': 'CZVR',
            'CZW': 'CZWG', 'CZY': 'CZYZ', 'CZX': 'CZQX', 'CZO': 'CZQO'
        };

        // Facility data
        const facilities = {
            // US ARTCCs
            ZAB: { type: 'ARTCC', name: 'Albuquerque', x: -107, y: 35 },
            ZAU: { type: 'ARTCC', name: 'Chicago', x: -88, y: 42 },
            ZBW: { type: 'ARTCC', name: 'Boston', x: -71, y: 42 },
            ZDC: { type: 'ARTCC', name: 'Washington', x: -77, y: 39 },
            ZDV: { type: 'ARTCC', name: 'Denver', x: -105, y: 40 },
            ZFW: { type: 'ARTCC', name: 'Fort Worth', x: -97, y: 33 },
            ZHU: { type: 'ARTCC', name: 'Houston', x: -95, y: 30 },
            ZID: { type: 'ARTCC', name: 'Indianapolis', x: -86, y: 40 },
            ZJX: { type: 'ARTCC', name: 'Jacksonville', x: -82, y: 30 },
            ZKC: { type: 'ARTCC', name: 'Kansas City', x: -95, y: 39 },
            ZLA: { type: 'ARTCC', name: 'Los Angeles', x: -118, y: 34 },
            ZLC: { type: 'ARTCC', name: 'Salt Lake City', x: -112, y: 41 },
            ZMA: { type: 'ARTCC', name: 'Miami', x: -80, y: 26 },
            ZME: { type: 'ARTCC', name: 'Memphis', x: -90, y: 35 },
            ZMP: { type: 'ARTCC', name: 'Minneapolis', x: -93, y: 45 },
            ZNY: { type: 'ARTCC', name: 'New York', x: -74, y: 41 },
            ZOA: { type: 'ARTCC', name: 'Oakland', x: -122, y: 38 },
            ZOB: { type: 'ARTCC', name: 'Cleveland', x: -82, y: 41 },
            ZSE: { type: 'ARTCC', name: 'Seattle', x: -122, y: 47 },
            ZTL: { type: 'ARTCC', name: 'Atlanta', x: -84, y: 34 },

            // Canadian FIRs
            CZVR: { type: 'FIR', name: 'Vancouver', x: -123, y: 49 },
            CZEG: { type: 'FIR', name: 'Edmonton', x: -114, y: 54 },
            CZWG: { type: 'FIR', name: 'Winnipeg', x: -97, y: 50 },
            CZYZ: { type: 'FIR', name: 'Toronto', x: -79, y: 44 },
            CZUL: { type: 'FIR', name: 'Montreal', x: -74, y: 46 },
            CZQM: { type: 'FIR', name: 'Moncton', x: -65, y: 46 },
            CZQX: { type: 'FIR', name: 'Gander Domestic', x: -55, y: 49 },
            CZQO: { type: 'OCEANIC', name: 'Gander Oceanic', x: -45, y: 52 },

            // US Oceanic
            KZAK: { type: 'OCEANIC', name: 'Oakland Oceanic', x: -140, y: 35 },
            KZWY: { type: 'OCEANIC', name: 'New York Oceanic', x: -55, y: 38 },
            KZAN: { type: 'ARTCC', name: 'Anchorage', x: -150, y: 61 },

            // North Atlantic
            BGGL: { type: 'NATL', name: 'Greenland', x: -42, y: 65 },
            BIRD: { type: 'NATL', name: 'Reykjavik', x: -20, y: 64 },
            EGGX: { type: 'NATL', name: 'Shanwick', x: -15, y: 54 },
            LPPO: { type: 'NATL', name: 'Santa Maria', x: -25, y: 38 }
        };

        // Adjacencies (edges)
        const adjacencies = [
            // CZVR (Vancouver) borders
            { from: 'CZVR', to: 'KZAN', type: 'LATERAL' },
            { from: 'CZVR', to: 'KZAK', type: 'OCEANIC' },
            { from: 'CZVR', to: 'CZEG', type: 'LATERAL' },
            { from: 'CZVR', to: 'ZSE', type: 'LATERAL' },

            // CZEG (Edmonton) borders
            { from: 'CZEG', to: 'KZAN', type: 'LATERAL' },
            { from: 'CZEG', to: 'CZWG', type: 'LATERAL' },
            { from: 'CZEG', to: 'ZSE', type: 'LATERAL' },
            { from: 'CZEG', to: 'ZLC', type: 'LATERAL' },
            { from: 'CZEG', to: 'BGGL', type: 'OCEANIC' },
            { from: 'CZEG', to: 'CZQO', type: 'OCEANIC' },
            { from: 'CZEG', to: 'CZUL', type: 'LATERAL' },

            // CZWG (Winnipeg) borders
            { from: 'CZWG', to: 'CZYZ', type: 'LATERAL' },
            { from: 'CZWG', to: 'CZUL', type: 'LATERAL' },
            { from: 'CZWG', to: 'ZMP', type: 'LATERAL' },
            { from: 'CZWG', to: 'ZLC', type: 'LATERAL' },

            // CZYZ (Toronto) borders
            { from: 'CZYZ', to: 'CZUL', type: 'LATERAL' },
            { from: 'CZYZ', to: 'ZMP', type: 'LATERAL' },
            { from: 'CZYZ', to: 'ZOB', type: 'LATERAL' },
            { from: 'CZYZ', to: 'ZBW', type: 'LATERAL' },

            // CZUL (Montreal) borders
            { from: 'CZUL', to: 'CZQM', type: 'LATERAL' },
            { from: 'CZUL', to: 'CZQX', type: 'OCEANIC' },
            { from: 'CZUL', to: 'CZQO', type: 'OCEANIC' },
            { from: 'CZUL', to: 'ZBW', type: 'LATERAL' },

            // CZQM (Moncton) borders
            { from: 'CZQM', to: 'ZBW', type: 'LATERAL' },
            { from: 'CZQM', to: 'KZWY', type: 'OCEANIC' },
            { from: 'CZQM', to: 'CZQX', type: 'OCEANIC' },

            // CZQX (Gander Domestic) borders
            { from: 'CZQX', to: 'CZQO', type: 'OCEANIC' },
            { from: 'CZQX', to: 'KZWY', type: 'OCEANIC' },

            // CZQO (Gander Oceanic) borders
            { from: 'CZQO', to: 'BGGL', type: 'OCEANIC' },
            { from: 'CZQO', to: 'KZWY', type: 'OCEANIC' },
            { from: 'CZQO', to: 'LPPO', type: 'OCEANIC' },
            { from: 'CZQO', to: 'EGGX', type: 'OCEANIC' },
            { from: 'CZQO', to: 'BIRD', type: 'OCEANIC' }
        ];

        // Color mapping
        const colors = {
            ARTCC: '#4a90d9',
            FIR: '#e94560',
            OCEANIC: '#00fff5',
            NATL: '#9b59b6'
        };

        // Create vis.js network
        let network = null;
        let allNodes = [];
        let allEdges = [];

        function initNetwork() {
            // Create nodes
            allNodes = Object.entries(facilities).map(([code, data]) => ({
                id: code,
                label: code,
                title: `${code} - ${data.name}`,
                color: {
                    background: colors[data.type],
                    border: '#fff',
                    highlight: { background: '#fff', border: colors[data.type] }
                },
                font: { color: '#fff', size: 14, face: 'monospace', bold: true },
                size: data.type === 'ARTCC' ? 25 : 20,
                x: (data.x + 150) * 10,
                y: -(data.y - 30) * 15,
                type: data.type
            }));

            // Create edges
            allEdges = adjacencies.map((adj, idx) => ({
                id: idx,
                from: adj.from,
                to: adj.to,
                color: { color: adj.type === 'LATERAL' ? '#ffffff55' : '#00fff555' },
                width: adj.type === 'LATERAL' ? 2 : 1,
                dashes: adj.type === 'OCEANIC',
                edgeType: adj.type
            }));

            updateNetwork();
        }

        function updateNetwork() {
            const showARTCC = document.getElementById('showARTCC').checked;
            const showFIR = document.getElementById('showFIR').checked;
            const showOceanic = document.getElementById('showOceanic').checked;
            const showNorthAtlantic = document.getElementById('showNorthAtlantic').checked;
            const showLateral = document.getElementById('showLateral').checked;
            const showOceanicEdge = document.getElementById('showOceanicEdge').checked;

            // Filter nodes
            const visibleTypes = [];
            if (showARTCC) visibleTypes.push('ARTCC');
            if (showFIR) visibleTypes.push('FIR');
            if (showOceanic) visibleTypes.push('OCEANIC');
            if (showNorthAtlantic) visibleTypes.push('NATL');

            const filteredNodes = allNodes.filter(n => visibleTypes.includes(n.type));
            const visibleNodeIds = new Set(filteredNodes.map(n => n.id));

            // Filter edges
            const filteredEdges = allEdges.filter(e => {
                if (!visibleNodeIds.has(e.from) || !visibleNodeIds.has(e.to)) return false;
                if (e.edgeType === 'LATERAL' && !showLateral) return false;
                if (e.edgeType === 'OCEANIC' && !showOceanicEdge) return false;
                return true;
            });

            // Update stats
            document.getElementById('nodeCount').textContent = filteredNodes.length;
            document.getElementById('edgeCount').textContent = filteredEdges.length;

            // Create/update network
            const container = document.getElementById('network');
            const data = {
                nodes: new vis.DataSet(filteredNodes),
                edges: new vis.DataSet(filteredEdges)
            };

            const options = {
                physics: {
                    enabled: true,
                    stabilization: { iterations: 100 },
                    barnesHut: {
                        gravitationalConstant: -3000,
                        springLength: 150,
                        springConstant: 0.02
                    }
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100
                },
                nodes: {
                    shape: 'circle',
                    borderWidth: 2
                },
                edges: {
                    smooth: { type: 'continuous' }
                }
            };

            if (network) {
                network.setData(data);
            } else {
                network = new vis.Network(container, data, options);

                network.on('click', function(params) {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        const facility = facilities[nodeId];
                        document.getElementById('selectedNode').textContent =
                            `${nodeId} (${facility.name})`;
                    } else {
                        document.getElementById('selectedNode').textContent = '-';
                    }
                });
            }
        }

        // Event listeners
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
            cb.addEventListener('change', updateNetwork);
        });

        // Facility dropdown functionality
        const facilitySelect = document.getElementById('facilitySelect');
        const tierConfigList = document.getElementById('tierConfigList');
        const clearBtn = document.getElementById('clearHighlight');

        // Populate facility dropdown
        const artccs = ['ZAB','ZAU','ZBW','ZDC','ZDV','ZFW','ZHU','ZID','ZJX','ZKC','ZLA','ZLC','ZMA','ZME','ZMP','ZNY','ZOA','ZOB','ZSE','ZTL'];
        artccs.forEach(artcc => {
            const option = document.createElement('option');
            option.value = artcc;
            option.textContent = `${artcc} (${facilities[artcc].name})`;
            facilitySelect.appendChild(option);
        });

        // Handle facility selection
        facilitySelect.addEventListener('change', function() {
            const facility = this.value;
            tierConfigList.innerHTML = '';

            if (!facility) {
                return;
            }

            // Handle special cases
            if (facility === 'ALL' || facility === 'ALL+Canada') {
                const config = tierConfigs[facility];
                const div = document.createElement('div');
                div.className = 'tier-config';
                const facilityCodes = config.facilities.split(' ').filter(f => f);
                div.innerHTML = `<span class="tier-config-code">${facility}</span> <span class="tier-config-type">${config.select}</span> <span class="tier-config-count">(${facilityCodes.length})</span>`;
                div.onclick = () => highlightFacilities(config.facilities, div);
                tierConfigList.appendChild(div);
                return;
            }

            // Get facility configs
            const facilityConfig = tierConfigs[facility];
            if (facilityConfig && facilityConfig.configs) {
                facilityConfig.configs.forEach(config => {
                    const div = document.createElement('div');
                    div.className = 'tier-config';
                    const facilityCodes = config.facilities.split(' ').filter(f => f);
                    div.innerHTML = `<span class="tier-config-code">${config.code}</span> <span class="tier-config-type">${config.select}</span> <span class="tier-config-count">(${facilityCodes.length})</span>`;
                    div.onclick = () => highlightFacilities(config.facilities, div);
                    tierConfigList.appendChild(div);
                });
            }
        });

        // Highlight facilities function
        function highlightFacilities(facilityStr, clickedElement) {
            // Clear previous active states
            document.querySelectorAll('.tier-config.active, .tier-group.active').forEach(el => el.classList.remove('active'));

            if (clickedElement) {
                clickedElement.classList.add('active');
            }

            clearBtn.style.display = 'block';

            // Parse facility codes and map short codes to full codes
            const codes = facilityStr.split(' ').filter(f => f).map(code => {
                return shortCodeMap[code] || code;
            });

            // Update all nodes
            const updatedNodes = allNodes.map(node => {
                const isHighlighted = codes.includes(node.id);
                return {
                    ...node,
                    color: {
                        background: isHighlighted ? colors[node.type] : '#333',
                        border: isHighlighted ? '#fff' : '#555',
                        highlight: { background: '#fff', border: colors[node.type] }
                    },
                    font: {
                        ...node.font,
                        color: isHighlighted ? '#fff' : '#666'
                    },
                    opacity: isHighlighted ? 1 : 0.3
                };
            });

            // Update the network
            const container = document.getElementById('network');
            const data = {
                nodes: new vis.DataSet(updatedNodes),
                edges: new vis.DataSet(allEdges)
            };
            network.setData(data);

            // Update stats
            document.getElementById('selectedNode').textContent = `${codes.length} facilities highlighted`;
        }

        // Clear highlight
        clearBtn.addEventListener('click', function() {
            document.querySelectorAll('.tier-config.active, .tier-group.active').forEach(el => el.classList.remove('active'));
            clearBtn.style.display = 'none';
            updateNetwork();
            document.getElementById('selectedNode').textContent = '-';
        });

        // Make named tier groups clickable
        document.querySelectorAll('.tier-group').forEach(group => {
            const name = group.querySelector('.tier-group-name').textContent;
            if (namedTierGroups[name]) {
                group.onclick = () => highlightFacilities(namedTierGroups[name], group);
            }
        });

        // Initialize
        initNetwork();
    </script>
</body>
</html>
